<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>VoiceFilter: Targeted Voice Separation by Speaker-Conditioned Spectrogram Masking</title>
  <link rel="stylesheet" type="text/css" href="../../resources/stylesheet.css">
  <link rel="shortcut icon" href="../../resources/logo.png">
  <style>
    code {
      display: block;
      white-space: pre-wrap
    }
  </style>
</head>

<body>
  <div>
    <h1>VoiceFilter: Targeted Voice Separation by Speaker-Conditioned Spectrogram Masking</h1>

    <p><b>News:</b>
      <ul>
        <li>Please check out our latest work on <a href="../VoiceFilter-Lite/index.html">VoiceFilter-Lite</a></li>
        <li>Our <a href="https://arxiv.org/abs/2104.13970">recent paper</a> on using VoiceFilter-Lite for speaker
          recognition and personalized keyphrase detection
        </li>
        <li>Our <a href="https://arxiv.org/abs/2107.01201">recent paper</a> and
          <a href="https://arxiv.org/abs/2202.12169">follow-up improvement</a> on multi-user VoiceFilter-Lite
        </li>
      </ul>
    </p>
    <p><b>Paper:</b> <a href="https://arxiv.org/abs/1810.04826">arXiv</a>
    </p>
    <p><b>Authors:</b> Quan Wang *, Hannah Muckenhirn *, Kevin Wilson,
      Prashant Sridhar, Zelin Wu, John Hershey, Rif A. Saurous, Ron J. Weiss,
      Ye Jia, Ignacio Lopez Moreno. <i>(*: Equal contribution.)</i>
    </p>

    <p><b>Abstract:</b>
      In this paper, we present a novel system that separates the voice of a target speaker from multi-speaker signals,
      by making use of a reference signal from the target speaker. We achieve this by training two separate neural
      networks: (1) A speaker recognition network that produces speaker-discriminative embeddings; (2) A spectrogram
      masking network that takes both noisy spectrogram and speaker embedding as input, and produces a mask. Our system
      significantly reduces the speech recognition WER on multi-speaker signals, with minimal WER degradation on
      single-speaker signals.
    </p>

    <p><b>System architecture:</b></p>
    <p><img src="resources/architecture.png" width="560"></p>

    <p><b>Lectures:</b></p>
    <iframe width="800" height="450" src="https://www.youtube.com/embed/gnRX2lzepz0" frameborder="0"
      allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <br><br>
    <iframe width="800" height="450" src="https://www.youtube.com/embed/c5HOuHSq6ag" frameborder="0"
      allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

    <p><b>Video demos:</b></p>
    <iframe width="800" height="450" src="https://www.youtube.com/embed/2BF_1X7bmds" frameborder="0"
      allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <br><br>
    <!-- <iframe width="800" height="450" src="https://www.youtube.com/embed/HNzxOOB0Gbw" frameborder="0"
      allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> -->

    <p><b>Citation:</b></p>
    <code>
      @inproceedings{Wang2019,
      author={Quan Wang and Hannah Muckenhirn and Kevin Wilson and Prashant Sridhar and Zelin Wu and John R. Hershey and
      Rif A. Saurous and Ron J. Weiss and Ye Jia and Ignacio Lopez Moreno},
      title={{VoiceFilter: Targeted Voice Separation by Speaker-Conditioned Spectrogram Masking}},
      year=2019,
      booktitle={Proc. Interspeech 2019},
      pages={2728--2732},
      doi={10.21437/Interspeech.2019-1101},
      url={http://dx.doi.org/10.21437/Interspeech.2019-1101}
      }
    </code>

    <h2>Random audio samples from LibriSpeech testing set</h2>

    <p>VoiceFilter model: CNN + bi-LSTM + fully connected</p>

    <h3>Apply VoiceFilter on noisy audio (2 speakers)</h3>

    <p>Meaning of the columns in the table below:
      <ol>
        <li>The noisy audio input to the VoiceFilter. It's generated by summing the clean audio with an interference
          audio from another speaker.</li>
        <li>The output from the VoiceFilter.</li>
        <li>The reference audio from which we extract the d-vector. The d-vector is another input to the VoiceFilter.
          This audio comes from the same speaker as the clean audio.</li>
        <li>The clean audio, which is the ground truth.</li>
      </ol>
    </p>
    <table>
      <thead>
        <tr>
          <th>Noisy audio input</th>
          <th>Enhanced audio output</th>
          <th>Reference audio for d-vector</th>
          <th>Clean audio (ground truth)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/4831-18525-0005.3576-138058-0010.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/4831-18525-0005.3576-138058-0010.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/4831-29134-0017.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/4831-18525-0005.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/6841-88291-0003.1585-157660-0013.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/6841-88291-0003.1585-157660-0013.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/6841-88294-0035.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/6841-88291-0003.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/1988-147956-0028.84-121123-0026.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/1988-147956-0028.84-121123-0026.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/1988-148538-0011.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/1988-147956-0028.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/251-137823-0002.6455-67803-0007.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/251-137823-0002.6455-67803-0007.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/251-137823-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/251-137823-0002.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/5849-50964-0009.6267-65525-0027.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/5849-50964-0009.6267-65525-0027.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/5849-50873-0018.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/5849-50964-0009.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/2078-142845-0028.4153-186222-0000.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/2078-142845-0028.4153-186222-0000.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/2078-142845-0015.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/2078-142845-0028.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/6241-61943-0015.84-121123-0002.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/6241-61943-0015.84-121123-0002.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/6241-66616-0019.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/6241-61943-0015.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/2902-9008-0008.116-288045-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/2902-9008-0008.116-288045-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/2902-9006-0010.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/2902-9008-0008.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/3081-166546-0036.3170-137482-0042.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/3081-166546-0036.3170-137482-0042.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/3081-166546-0016.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/3081-166546-0036.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/noisy/1701-141760-0023.251-136532-0023.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/2_speakers/enhanced/1701-141760-0023.251-136532-0023.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/1701-141759-0022.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/1701-141760-0023.wav" type="audio/wav"></audio></td>
        </tr>
      </tbody>
    </table>

    <h3>Apply VoiceFilter on clean audio (single speaker)</h3>

    <p>Meaning of the columns in the table below:
      <ol>
        <li>The clean audio, which we feed as the input to the VoiceFilter.</li>
        <li>The output from the VoiceFilter.</li>
        <li>The reference audio from which we extract the d-vector. The d-vector is another input to the VoiceFilter.
          This audio comes from the same speaker as the clean audio.</li>
      </ol>
    </p>
    <table>
      <thead>
        <tr>
          <th>Clean audio input</th>
          <th>Enhanced audio output</th>
          <th>Reference audio for d-vector</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/4831-18525-0005.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/4831-18525-0005.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/4831-29134-0017.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/6841-88291-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/6841-88291-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/6841-88294-0035.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/1988-147956-0028.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/1988-147956-0028.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/1988-148538-0011.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/251-137823-0002.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/251-137823-0002.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/251-137823-0003.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/5849-50964-0009.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/5849-50964-0009.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/5849-50873-0018.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/2078-142845-0028.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/2078-142845-0028.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/2078-142845-0015.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/6241-61943-0015.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/6241-61943-0015.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/6241-66616-0019.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/2902-9008-0008.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/2902-9008-0008.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/2902-9006-0010.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/3081-166546-0036.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/3081-166546-0036.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/3081-166546-0016.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/clean/1701-141760-0023.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/single_speaker/enhanced/1701-141760-0023.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios/reference/1701-141759-0022.wav" type="audio/wav"></audio></td>
        </tr>
      </tbody>
    </table>

    <h2>FAQ</h2>

    <h3>Can you share your code?</h3>

    <p>
      Unfortunately, the original VoiceFilter system heavily depends on
      Google's internal infrastructure and data, thus cannot be open sourced.
    </p>

    <p>
      However, thanks for the efforts by
      <a href="http://swpark.me/">Seungwon Park</a>, a <b>third-party</b>
      unofficial implementation using PyTorch is available on GitHub:
    </p>

    <p>
      <a href="https://github.com/mindslab-ai/voicefilter">https://github.com/mindslab-ai/voicefilter</a>
    </p>

    <p>
      Please note that we are not responsible for the correctness or quality of third-party implementations. Please use
      your own judgement to decide whether you want to use these implementations.
    </p>

    <h3>In Table 4 of your paper, why SDR of "No VoiceFilter" is so high? Does it mean your problem is very easy?</h3>

    <p>No. The high SDR is because of the way we prepare our training data - we trim the noisy audio to be the same
      length as the clean audio for training.</p>

    <p>For example, if the clean audio is 5 seconds, the interference audio is 1 second, then the resulting noisy audio
      will consist of 1 second of really noisy audio, and 4 seconds of actually clean audio. Thus a big part of our
      "noisy" audios are actually clean, and when we compute the SDR statistically, we get very large numbers
      (especially the mean).</p>

    <p>However, since we use the same volume for clean and interference audios, if we only look at the really noisy
      parts of the noisy audio, the theoretical SDR should be 0.</p>

    <p>So the conclusion: We are <b>NOT</b> solving a problem which is easier than others.</p>

    <h2>Dataset information</h2>

    <p>
      For training and evaluating our VoiceFilter models, we had been using the
      VCTK and LibriSpeech datasets.
    </p>
    <p>
      Here we provide the division of
      training-vs-testing as CSV files. Each line of the CSV files is a tuple
      of three utterance IDs:
    </p>
    <p>
      <b>
        (clean utterance, utterance for computing d-vector, interference utterance)
      </b>
      <li>
        <a href="https://github.com/google/speaker-id/tree/master/publications/VoiceFilter/dataset/VCTK">
          VCTK training and testing</a>
      </li>
      <li>
        <a href="https://github.com/google/speaker-id/tree/master/publications/VoiceFilter/dataset/LibriSpeech">
          LibriSpeech training and testing</a>
      </li>
    </p>

    <h2>Media coverage</h2>
    <li><a
        href="https://venturebeat.com/2018/10/12/google-researchers-use-ai-to-pick-out-voices-in-a-crowd/">VentureBeat</a>
    </li>
    <li><a href="https://tproger.ru/news/google-pick-out-voice/">Tproger</a></li>
    <li><a href="https://www.jiqizhixin.com/articles/2018-10-17-8">机器之心</a></li>
    <li><a href="http://www.sohu.com/a/259401844_473283">新智元</a></li>
    <li><a
        href="https://medium.com/%E6%88%91%E5%B0%B1%E5%95%8F%E4%B8%80%E5%8F%A5-%E6%80%8E%E9%BA%BC%E5%AF%AB/voicefilter-a-speakerid-based-speech-separation-by-google-ai-760ca30d81f">Medium</a>
    </li>
  </div>
</body>

</html>